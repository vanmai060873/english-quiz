<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<title>Trắc nghiệm kiến thức Sunny và Lucy</title>

<style>

body{
font-family:Arial;
margin:0;
display:flex;
height:100vh;
}

#sidebar{

width:20%;
background:#f4f4f4;
overflow-y:auto;
padding:10px;
border-right:1px solid #ccc;

}

#sidebar button{

width:42px;
height:42px;
margin:4px;
border:none;
background:#ddd;
cursor:pointer;

}

.done{

background:#4caf50 !important;
color:white;

}

.correctNav{

background:green !important;
color:white;

}

.wrongNav{

background:red !important;
color:white;

}

#content{

width:80%;
padding:20px;
overflow-y:auto;

}

.question{

padding:15px;
margin-bottom:15px;
border-radius:8px;
border:1px solid #ddd;

}

.even{background:#e6f4ea;}
.odd{background:#ffe8cc;}

.question-title{

font-weight:bold;
color:#800000;

}

.correct{

color:green;
font-weight:bold;

}

.wrong{

color:red;
font-weight:bold;

}

#timer{

font-size:20px;
color:red;
font-weight:bold;

}

#popup{

display:none;
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.5);

justify-content:center;
align-items:center;

}

#popupContent{

background:white;
padding:30px;
border-radius:10px;
width:420px;
text-align:center;

}

button{

padding:10px 15px;
margin:5px;

}

</style>

</head>

<body>

<div id="sidebar"></div>

<div id="content">

<h2>Trắc nghiệm kiến thức Sunny và Lucy</h2>

<div id="nameSection">

Tên:

<input id="studentName">

<button onclick="startQuiz()">BẮT ĐẦU</button>

</div>

<div id="quizSection" style="display:none">

<div id="timer">100:00</div>

<div id="quiz"></div>

<button onclick="finishQuiz()">KẾT THÚC</button>

<button id="wrongBtn"
onclick="toggleWrong()"
style="display:none">

CHỈ XEM CÂU SAI

</button>

</div>

</div>

<div id="popup">

<div id="popupContent">

<h3 id="popupResult"></h3>

<button onclick="retakeQuiz()">THI LẠI</button>

<button onclick="closePopup()">ĐÓNG</button>

</div>

</div>

<script>

let allQuestions=[];
let currentQuestions=[];
let submitted=false;
let showWrongOnly=false;

let totalQuestions=200;

let timeLeft=100*60;

let timer;

let studentName="";

fetch("questions.txt")

.then(r=>r.text())

.then(text=>{

text=text.replace(/\r\n/g,"\n");

let lines=text.split("\n");

for(let i=0;i<lines.length;i++){

if(

lines[i] &&

lines[i+1]?.startsWith("A.")&&

lines[i+2]?.startsWith("B.")&&

lines[i+3]?.startsWith("C.")&&

lines[i+4]?.startsWith("D.")&&

lines[i+5]?.startsWith("ANSWER")

){

allQuestions.push({

question:lines[i],

options:[

lines[i+1],

lines[i+2],

lines[i+3],

lines[i+4]

],

answer:

lines[i+5]

.replace("ANSWER:","")

.trim()

});

}

}

});

function startQuiz(){

studentName=document

.getElementById("studentName")

.value.trim();

if(studentName===""){

alert("Nhập tên!");

return;

}

nameSection.style.display="none";

quizSection.style.display="block";

loadQuiz();

}

function shuffle(a){

return a.sort(()=>Math.random()-0.5);

}

function loadQuiz(){

submitted=false;

showWrongOnly=false;

wrongBtn.style.display="none";

quiz.innerHTML="";

sidebar.innerHTML="";

currentQuestions=

shuffle([...allQuestions])

.slice(0,totalQuestions);

startTimer();

currentQuestions.forEach((q,i)=>{

let nav=document.createElement("button");

nav.innerText=i+1;

nav.id="nav"+i;

nav.onclick=()=>{

document.getElementById("q"+i)

.scrollIntoView({behavior:"smooth"});

};

sidebar.appendChild(nav);

let div=document.createElement("div");

div.className="question "+(i%2?"odd":"even");

div.id="q"+i;

let html=

`<p class="question-title">

${i+1}. ${q.question}

</p>`;

shuffle([...q.options])

.forEach(opt=>{

let letter=opt.charAt(0);

html+=`

<label>

<input type="radio"

name="q${i}"

value="${letter}"

onchange="markDone(${i})">

${opt}

</label><br>`;

});

div.innerHTML=html;

quiz.appendChild(div);

});

}

function markDone(i){

if(!submitted)

document.getElementById("nav"+i)

.classList.add("done");

}

function startTimer(){

clearInterval(timer);

timeLeft=100*60;

timer=setInterval(()=>{

let m=Math.floor(timeLeft/60);

let s=timeLeft%60;

timerEl.innerText=

`${m}:${s<10?'0':''}${s}`;

timeLeft--;

if(timeLeft<0)

finishQuiz();

},1000);

}

function finishQuiz(){

if(submitted)return;

submitted=true;

clearInterval(timer);

let correctCount=0;

let firstWrong=null;

currentQuestions.forEach((q,i)=>{

let correct=q.answer;

let selected=

document.querySelector(

`input[name=q${i}]:checked`

);

let div=document

.getElementById("q"+i);

let nav=document

.getElementById("nav"+i);

div.querySelectorAll("label")

.forEach(lb=>{

let radio=

lb.querySelector("input");

if(radio.value===correct)

lb.classList.add("correct");

});

if(selected){

if(selected.value===correct){

correctCount++;

nav.className="correctNav";

}

else{

selected.parentElement

.classList.add("wrong");

nav.className="wrongNav";

if(!firstWrong)

firstWrong=div;

}

}

});

document

.querySelectorAll(

"input[type=radio]"

)

.forEach(r=>r.disabled=true);

let score=

(correctCount*(10/totalQuestions))

.toFixed(2);

popupResult.innerHTML=

`<b>${studentName}</b>

<br>

Đúng ${correctCount}/${totalQuestions}

<br>

Điểm ${score}/10`;

popup.style.display="flex";

wrongBtn.style.display="inline-block";

if(firstWrong)

firstWrong.scrollIntoView({

behavior:"smooth"

});

}

function toggleWrong(){

if(!submitted){

alert("Phải kết thúc bài trước!");

return;

}

showWrongOnly=!showWrongOnly;

currentQuestions

.forEach((q,i)=>{

let div=

document.getElementById("q"+i);

let nav=

document.getElementById("nav"+i);

if(showWrongOnly){

if(nav.classList

.contains("wrongNav")){

div.style.display="block";

nav.style.display="inline-block";

}

else{

div.style.display="none";

nav.style.display="none";

}

}

else{

div.style.display="block";

nav.style.display="inline-block";

}

});

}

function retakeQuiz(){

popup.style.display="none";

loadQuiz();

}

function closePopup(){

popup.style.display="none";

}

</script>

</body>

</html>

